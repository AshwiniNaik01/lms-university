import{r as x,q as J,a as K,m as Q,j as e,C as N,w as u,v as X,a1 as W}from"./index-BlaCQYdb.js";import{u as Y}from"./useCourseParam-Cp9FvxYK.js";const Z=({title:b,values:w,onSave:i,onClose:P,type:p="edit"})=>{const[a,g]=x.useState(w),f=(r,n)=>g({...a,[r]:n}),j=(r,n,m)=>{const h=[...a.points||[]];h[r][n]=m,g({...a,points:h})},S=()=>{g({...a,points:[...a.points||[],{title:"",description:""}]})},y=r=>{const n=a.points.filter((m,h)=>h!==r);g({...a,points:n})};return e.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-black/40 backdrop-blur-sm z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl w-[600px] shadow-2xl p-6 relative max-h-[85vh] overflow-y-auto",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[p==="delete"?"ðŸ—‘ï¸":"âœï¸"," ",b]}),p==="delete"?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-6xl mb-4",children:"âš ï¸"}),e.jsx("p",{className:"text-gray-700 text-lg mb-2",children:"Are you sure you want to delete this?"}),e.jsx("p",{className:"text-gray-500",children:"This action cannot be undone."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-gray-700 text-sm font-semibold mb-2 block",children:"Title"}),e.jsx("input",{type:"text",value:a.title||"",onChange:r=>f("title",r.target.value),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all",placeholder:"Enter title..."})]}),a.description!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-gray-700 text-sm font-semibold mb-2 block",children:"Description"}),e.jsx("textarea",{value:a.description||"",onChange:r=>f("description",r.target.value),rows:"3",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all resize-none",placeholder:"Enter description..."})]}),a.weekNumber!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-gray-700 text-sm font-semibold mb-2 block",children:"Module's Number"}),e.jsx("input",{type:"number",value:a.weekNumber||"",onChange:r=>f("weekNumber",parseInt(r.target.value)),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all",min:"1"})]}),a.points!==void 0&&e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("label",{className:"text-gray-700 text-sm font-semibold",children:"Learning Points"}),e.jsx("button",{type:"button",onClick:S,className:"bg-green-500 text-white px-3 py-1 rounded-lg text-sm hover:bg-green-600 transition-all",children:"âž• Add Point"})]}),e.jsx("div",{className:"space-y-4 max-h-60 overflow-y-auto",children:(a.points||[]).map((r,n)=>e.jsxs("div",{className:"border-2 border-gray-200 rounded-xl p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsxs("h4",{className:"text-sm font-semibold text-gray-700",children:["Point ",n+1]}),e.jsx("button",{onClick:()=>y(n),className:"text-red-500 hover:text-red-700 text-sm font-medium",children:"ðŸ—‘ï¸ Remove"})]}),e.jsx("input",{type:"text",placeholder:"Point Title",value:r.title,onChange:m=>j(n,"title",m.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg mb-2 focus:ring-2 focus:ring-blue-200"}),e.jsx("textarea",{placeholder:"Description",value:r.description,onChange:m=>j(n,"description",m.target.value),rows:"2",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-200 resize-none"})]},n))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-8 pt-6 border-t border-gray-200",children:[e.jsx("button",{onClick:P,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl font-semibold hover:bg-gray-300 transition-all",children:"Cancel"}),e.jsx("button",{onClick:()=>i(a),className:`px-6 py-3 rounded-xl font-semibold text-white flex items-center gap-2 transition-all ${p==="delete"?"bg-red-500 hover:bg-red-600":"bg-blue-500 hover:bg-blue-600"}`,children:p==="delete"?"ðŸ—‘ï¸ Delete":"ðŸ’¾ Save Changes"})]})]})})},ee=({message:b,type:w,onClose:i})=>e.jsxs("div",{className:`fixed top-6 right-6 px-6 py-3 rounded-xl shadow-2xl text-white font-semibold z-50 flex items-center gap-3 animate-slide-in ${w==="success"?"bg-green-500":"bg-red-500"}`,children:[e.jsx("span",{children:b}),e.jsx("button",{onClick:i,className:"text-white hover:text-gray-200 font-bold",children:"âœ•"})]}),re=()=>{const[b,w]=x.useState([]),[i,P]=x.useState(""),[p,a]=x.useState([]),[g,f]=x.useState(null),[j,S]=x.useState(null),[y,r]=x.useState(!1),[n,m]=x.useState(null),[h,o]=x.useState(null),{rolePermissions:c}=J(t=>t.permissions),C=K(),[_,,I]=Y(b),k=t=>t?.trim()?.length>0,T=(t=[])=>t.filter(s=>k(s.title)||k(s.description)),$=(t=[])=>t.filter(s=>k(s.title)||T(s.points).length>0||s.lectures?.length>0||s.assignments?.length>0),M=(t=[])=>t.filter(s=>k(s.title)||$(s.chapters).length>0),V=((t=[])=>t.filter(s=>k(s.title)||M(s.weeks).length>0))(p),v=(t,s="success")=>{m({message:t,type:s}),setTimeout(()=>m(null),3e3)};x.useEffect(()=>{(async()=>{try{const s=await X();w(s||[])}catch{v(`âŒ Failed to load ${N}`,"error")}})()},[]),x.useEffect(()=>{_&&b.length>0&&(P(_),E(_))},[_,b]);const E=async t=>{if(t){r(!0);try{const s=await Q(t);a(s?.phases||[])}catch{v("âŒ Failed to load curriculum","error")}finally{r(!1)}}},z=t=>{const s=t.target.value;P(s),f(null),S(null),s&&E(s)},A=async(t,s,l)=>{r(!0);try{await W.put(t,s),v(`âœ… ${l}`,"success"),E(i)}catch(d){v(`âŒ Failed to update: ${d.response?.data?.message||d.message}`,"error")}finally{r(!1)}},F=async(t,s)=>{r(!0);try{await W.delete(t),v(`âœ… ${s}`,"success"),E(i)}catch(l){v(`âŒ Failed to delete: ${l.response?.data?.message||l.message}`,"error")}finally{r(!1)}},R=t=>{o({title:"Edit Phase",values:{title:t.title,description:t.description,course:i},onSave:s=>{o(null),A(`/api/phases/${t._id}`,s,"Schedule updated successfully!")}})},L=t=>{o({title:"Delete Schedule",values:{},onSave:()=>{o(null),F(`/api/phases/${t._id}`,"Schedule deleted successfully!")},type:"delete"})},O=t=>{o({title:"Edit Module",values:{title:t.title,weekNumber:t.weekNumber,phase:t.phase},onSave:s=>{o(null),A(`/api/weeks/${t._id}`,s,"Module updated successfully!")}})},q=t=>{o({title:"Delete Module",values:{},onSave:()=>{o(null),F(`/api/weeks/${t._id}`,"Module deleted successfully!")},type:"delete"})},B=t=>{o({title:"Edit Course Content",values:{title:t.title||"",points:t.points||[],week:t.week},onSave:s=>{o(null),A(`/api/chapters/${t._id}`,s,"Course Content updated successfully!")}})},U=t=>{o({title:"Delete Course Content",values:{},onSave:()=>{o(null),F(`/api/chapters/${t._id}`,"Course Content deleted successfully!")},type:"delete"})};return e.jsx("div",{className:"max-h-fit bg-gradient-to-br from-blue-50 via-white to-purple-50 py-2",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4",children:[e.jsxs("div",{className:"text-start mb-2",children:[e.jsx("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4",children:"ðŸ“š Manage Curriculum"}),e.jsx("hr",{})]}),e.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 mb-2 ${I?"opacity-50 pointer-events-none":""}`,children:[e.jsxs("label",{className:"block text-lg font-semibold text-gray-700 mb-3",children:["ðŸŽ¯ Select ",N]}),e.jsxs("select",{value:i,onChange:z,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all",disabled:I,children:[e.jsxs("option",{value:"",children:["-- Choose a ",N," --"]}),b.map(t=>e.jsx("option",{value:t._id,children:t.title},`course-${t._id}`))]})]}),y&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-semibold",children:"Loading..."})]}),!y&&V.length>0&&e.jsxs("div",{className:"space-y-6",children:[V.map((t,s)=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden border-2 border-gray-100 hover:border-blue-200 transition-all duration-300",children:[e.jsxs("div",{onClick:()=>f(g===t._id?null:t._id),className:"flex justify-between items-center p-6 cursor-pointer bg-gradient-to-r from-blue-50 to-purple-50 hover:from-blue-100 hover:to-purple-100 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-500 rounded-xl flex items-center justify-center text-white text-xl",children:s+1}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:t.title}),e.jsx("p",{className:"text-gray-600",children:t.description})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[u(c,"curriculum","update")&&e.jsx("button",{onClick:l=>{l.stopPropagation(),R(t)},className:"w-10 h-10 bg-blue-500 text-white rounded-lg flex items-center justify-center hover:bg-blue-600 transition-all",children:"âœï¸"}),u(c,"curriculum","delete")&&e.jsx("button",{onClick:l=>{l.stopPropagation(),L(t)},className:"w-10 h-10 bg-red-500 text-white rounded-lg flex items-center justify-center hover:bg-red-600 transition-all",children:"ðŸ—‘ï¸"}),e.jsx("span",{className:"text-2xl text-blue-600",children:g===t._id?"ðŸ”½":"â–¶ï¸"})]})]}),g===t._id&&M(t.weeks).length>0&&e.jsxs("div",{className:"p-6 bg-gray-50 space-y-4",children:[M(t.weeks).map(l=>e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 overflow-hidden",children:[e.jsxs("div",{onClick:()=>S(j===l._id?null:l._id),className:"flex justify-between items-center p-4 cursor-pointer bg-gradient-to-r from-gray-50 to-blue-50 hover:from-gray-100 hover:to-blue-100 transition-all",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-blue-500 rounded-lg flex items-center justify-center text-white",children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-800",children:["Week ",l.weekNumber,": ",l.title]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[$(l.chapters).length||0," Course Content"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[u(c,"curriculum","update")&&e.jsx("button",{onClick:d=>{d.stopPropagation(),O(l)},className:"w-8 h-8 bg-blue-500 text-white rounded-lg flex items-center justify-center hover:bg-blue-600 transition-all text-sm",children:"âœï¸"}),u(c,"curriculum","delete")&&e.jsx("button",{onClick:d=>{d.stopPropagation(),q(l)},className:"w-8 h-8 bg-red-500 text-white rounded-lg flex items-center justify-center hover:bg-red-600 transition-all text-sm",children:"ðŸ—‘ï¸"}),e.jsx("span",{className:"text-2xl text-blue-600",children:j===l._id?"ðŸ”½":"â–¶ï¸"})]})]}),j===l._id&&e.jsx("div",{className:"p-4 bg-white space-y-3",children:$(l.chapters).length>0?e.jsxs(e.Fragment,{children:[$(l.chapters).map((d,G)=>e.jsx("div",{className:"border-2 border-gray-200 rounded-lg p-4 bg-gradient-to-r from-gray-50 to-white hover:from-blue-50 transition-all",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-500 to-red-500 rounded-lg flex items-center justify-center text-white text-sm mt-1",children:"ðŸ“š"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-semibold text-gray-800 mb-2",children:d.title||`Course Content ${G+1}`}),e.jsx("div",{className:"space-y-2",children:T(d.points).map((D,H)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"text-green-500 mt-1",children:"âœ…"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:D.title}),D.description&&e.jsx("p",{className:"text-gray-600 text-xs mt-1",children:D.description})]})]},D._id||H))})]})]}),e.jsxs("div",{className:"flex gap-2",children:[u(c,"curriculum","update")&&e.jsx("button",{onClick:()=>B(d),className:"w-8 h-8 bg-blue-500 text-white rounded-lg flex items-center justify-center hover:bg-blue-600 transition-all text-sm",children:"âœï¸"}),u(c,"curriculum","delete")&&e.jsx("button",{onClick:()=>U(d),className:"w-8 h-8 bg-red-500 text-white rounded-lg flex items-center justify-center hover:bg-red-600 transition-all text-sm",children:"ðŸ—‘ï¸"})]})]})},d._id)),e.jsx("div",{className:"flex justify-center pt-4",children:u(c,"curriculum","create")&&e.jsx("button",{onClick:()=>C(`/add-curriculum?type=chapter&weekId=${l._id}&courseId=${i}`),className:"bg-amber-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-amber-600 transition-all flex items-center gap-2",children:"ðŸ“š Add Course Content to this Module"})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ“š"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No course contents yet in this module."}),u(c,"curriculum","create")&&e.jsx("button",{onClick:()=>C(`/add-curriculum?type=chapter&weekId=${l._id}&courseId=${i}`),className:"bg-amber-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-amber-600 transition-all flex items-center gap-2 mx-auto",children:"ðŸ“š Add First Course Content"})]})})]},l._id)),e.jsx("div",{className:"flex justify-center pt-4",children:u(c,"curriculum","create")&&e.jsx("button",{onClick:()=>C(`/add-curriculum?type=week&phaseId=${t._id}&courseId=${i}`),className:"bg-green-500 text-white px-6 py-3 rounded-xl font-semibold hover:bg-green-600 transition-all flex items-center gap-2",children:"âž• Add Module to this Schedule"})})]})]},t._id)),e.jsx("div",{className:"flex justify-center pt-6",children:u(c,"curriculum","create")&&e.jsx("button",{onClick:()=>C(`/add-curriculum?type=phase&courseId=${i}`),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-4 rounded-xl font-semibold hover:shadow-xl transition-all flex items-center gap-2 text-lg",children:"ðŸ—ï¸ Add New Schedule"})})]}),!y&&i&&p.length===0&&e.jsxs("div",{className:"text-center py-16 bg-white rounded-2xl shadow-lg",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"No Curriculum Found"}),e.jsxs("p",{className:"text-gray-500 mb-6",children:["This ",N," doesn't have any curriculum yet."]}),u(c,"curriculum","create")&&e.jsx("button",{onClick:()=>C(`/add-curriculum?courseId=${i}`),className:"bg-gradient-to-r from-blue-500 to-purple-500 text-white px-8 py-3 rounded-xl font-semibold hover:shadow-xl transition-all",children:"ðŸš€ Create Curriculum"})]}),!y&&!i&&e.jsxs("div",{className:"text-center py-20 bg-white rounded-2xl shadow-lg",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸŽ¯"}),e.jsxs("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:["Select a ",N]}),e.jsxs("p",{className:"text-gray-500",children:["Choose a ",N," from the dropdown above to manage its curriculum."]})]}),n&&e.jsx(ee,{message:n.message,type:n.type,onClose:()=>m(null)}),h&&e.jsx(Z,{title:h.title,values:h.values,onSave:h.onSave,onClose:()=>o(null),type:h.type})]})})};export{re as default};
