import{u as E,r as a,q as _,a as I,j as e,C as n,s as L,t as P,M,v as O,S as l,w as d,x as z,y as Y,z as R,A as V,B as q,G as H,m as Q,H as G,J}from"./index-BlaCQYdb.js";const Z=()=>{const{token:K}=E(),[v,h]=a.useState([]),[C,x]=a.useState(!1),[m,U]=a.useState(""),[w,g]=a.useState(null),{rolePermissions:c}=_(s=>s.permissions),[f,N]=a.useState(""),[k,W]=a.useState("newest"),[A,j]=a.useState(!1),[r,p]=a.useState(null),[S,b]=a.useState(!1),o=I(),y=async()=>{x(!0);try{const s=await O();h(Array.isArray(s)?s:[])}catch(s){console.error(`Error fetching ${n}:`,s),l.fire({icon:"error",title:`Failed to load ${n}`,text:"Please try again later"})}finally{x(!1)}};a.useEffect(()=>{y()},[]);const B=async s=>{if(!d(c,"course","delete")){l.fire({icon:"error",title:"Permission Denied",text:`You do not have permission to delete this ${n}.`});return}if((await l.fire({title:"Are you sure?",text:`Do you really want to delete this ${n}?`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed){g(s);try{await J(s),h(i=>i.filter(u=>u._id!==s)),l.fire({icon:"success",title:"Deleted!",text:`${n} deleted successfully.`,confirmButtonColor:"#28a745"})}catch(i){l.fire({icon:"error",title:"Deletion Failed",text:i.message||`Failed to delete ${n}.`,confirmButtonColor:"#d33"})}finally{g(null)}}},F=async s=>{b(!0),j(!0);try{const t=await Q(s);p(t)}catch(t){console.error(t),p(null),l.fire({icon:"error",title:"Error",text:t.message||`Failed to fetch ${n} details`})}finally{b(!1)}},$=async s=>{if(!d(c,"course","create")){l.fire({icon:"error",title:"Permission Denied",text:`You do not have permission to clone this ${n}.`});return}if((await l.fire({title:"Are you sure?",text:`Do you want to clone this ${n}?`,icon:"question",showCancelButton:!0,confirmButtonText:"Yes, clone it!",cancelButtonText:"Cancel"})).isConfirmed)try{const i=await G(s);i.success?(l.fire({icon:"success",title:"Cloned!",text:i.message||`${n} cloned successfully.`}),y()):l.fire({icon:"error",title:"Failed",text:i.message||`Failed to clone ${n}.`})}catch(i){l.fire({icon:"error",title:"Error",text:i.message||"Please Try Again !!"})}},T=[{header:"Title",accessor:"title"},{header:"Batches Assigned",accessor:s=>{const t=s.batches?.length>0;return e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>{o(t?`/manage-batches?courseId=${s._id}`:`/add-batch?courseId=${s._id}`)},title:t?"View Batch":"Add Batch",className:`
            px-4 py-2 rounded-full font-semibold transition-transform
            ${t?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-md hover:scale-105 hover:from-blue-600 hover:to-blue-700":"bg-gray-300 text-gray-800 shadow-inner hover:scale-105"}
          `,children:s.batches?.length||0})})}},{header:"Actions",accessor:s=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>F(s._id),title:"View",className:"p-2 bg-sky-500 text-white rounded hover:bg-sky-600",children:e.jsx(z,{size:16})}),d(c,"course","update")&&e.jsx("button",{onClick:()=>o(`/courses/edit/${s._id}`),title:"Edit",className:"p-2 bg-amber-400 text-white rounded hover:bg-amber-500",children:e.jsx(Y,{size:16})}),d(c,"course","create")&&e.jsx("button",{onClick:()=>$(s._id),title:"Clone",className:"p-2 bg-violet-600 text-white rounded hover:bg-violet-700",children:e.jsx(R,{size:16})}),e.jsx("button",{onClick:()=>o(`/add-curriculum?type=phase&courseId=${s._id}`),title:"Add Curriculum",className:"p-2 bg-emerald-600 text-white rounded hover:bg-emerald-700",children:e.jsx(V,{size:16})}),e.jsx("button",{onClick:()=>o(`/manage-curriculum?courseId=${s._id}`),title:"Manage Curriculum",className:"p-2  bg-teal-600 text-white rounded hover:bg-teal-700",children:e.jsx(q,{size:16})}),d(c,"course","delete")&&e.jsx("button",{onClick:()=>B(s._id),disabled:w===s._id,title:"Delete",className:"p-2 bg-rose-600 text-white rounded hover:bg-rose-700 disabled:opacity-50",children:e.jsx(H,{size:16})})]})}],D=v.filter(s=>s.title.toLowerCase().includes(f.toLowerCase())).sort((s,t)=>{const i=new Date(s.createdAt),u=new Date(t.createdAt);return k==="newest"?u-i:i-u});return C?e.jsx("div",{className:"text-center p-4 text-indigo-600",children:"Loading..."}):m?e.jsx("div",{className:"text-center p-4 text-red-600 font-semibold",children:m}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white shadow-md px-6 py-4 rounded-md sticky top-0 z-10 gap-4",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-700 tracking-wide",children:["Manage ",n]}),e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-72",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-sky-800",size:16}),e.jsx("input",{type:"text",placeholder:"Search training...",value:f,onChange:s=>N(s.target.value),className:"pl-10 pr-4 py-2 border border-sky-600 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 w-full shadow-sm"})]}),e.jsx("button",{onClick:()=>o("/add-courses"),className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-all duration-200 shadow",children:"+ Create Training"})]})]}),e.jsx("div",{className:"bg-white shadow-sm rounded-md p-4",children:e.jsx("div",{className:"max-h-[500px] overflow-auto rounded-md border",children:e.jsx(P,{columns:T,data:D,maxHeight:"500px",emptyMessage:`No ${n} Found`})})}),e.jsx(M,{isOpen:A,onClose:()=>j(!1),header:r?r.title:"Loading...",children:S?e.jsx("p",{className:"text-gray-500 text-center py-6",children:"Loading..."}):r?e.jsxs("div",{className:"space-y-4 text-gray-700",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Description:"})," ",r.description]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Overview:"})," ",r.overview]}),r.learningOutcomes?.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Learning Outcomes:"}),e.jsx("ul",{className:"list-disc ml-5 space-y-1",children:r.learningOutcomes.map((s,t)=>e.jsx("li",{children:s},t))})]}),r.benefits?.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Benefits:"}),e.jsx("ul",{className:"list-disc ml-5 space-y-1",children:r.benefits.map((s,t)=>e.jsx("li",{children:s},t))})]}),r.keyFeatures?.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Key Features:"}),e.jsx("ul",{className:"list-disc ml-5 space-y-2",children:r.keyFeatures.map(s=>e.jsxs("li",{children:[e.jsxs("strong",{children:[s.title,":"]})," ",s.description,s.subPoints?.length>0&&e.jsx("ul",{className:"list-decimal ml-5 mt-1",children:s.subPoints.map((t,i)=>e.jsx("li",{children:t},i))})]},s._id))})]}),r.trainer?.length>0&&e.jsxs("div",{children:[e.jsx("strong",{children:"Trainer Info:"}),r.trainer.map(s=>e.jsxs("div",{className:"border border-gray-200 p-3 rounded-md mb-3",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Name:"})," ",s.fullName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Title:"})," ",s.title]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Qualification:"})," ",s.highestQualification]}),e.jsxs("p",{children:[e.jsx("strong",{children:"College:"})," ",s.collegeName]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Total Experience:"})," ",s.totalExperience]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Available Timing:"})," ",s.availableTiming]}),e.jsxs("p",{children:[e.jsx("strong",{children:"LinkedIn:"})," ",e.jsx("a",{href:s.linkedinProfile?.trim(),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:s.linkedinProfile?.trim()})]})]},s._id))]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Rating:"})," ",r.rating]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Enrolled Count:"})," ",r.enrolledCount]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",r.isActive?"Active":"Inactive"]})]}):e.jsx("p",{className:"text-gray-500 text-center py-6",children:"No data found."})})]})};export{Z as default};
