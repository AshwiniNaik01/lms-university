import{b as w,a as v,r as c,a1 as u,S as o,j as e,aF as A}from"./index-BlaCQYdb.js";const S=()=>{const{meetingId:r}=w(),f=v(),[p,g]=c.useState(null),[a,d]=c.useState([]),[x,h]=c.useState(!0),[m,b]=c.useState(!1);c.useEffect(()=>{if(!r){console.error("No meetingId found in URL"),h(!1);return}u.get(`/api/meetings/${r}`).then(t=>{const s=t.data?.data;g(s);const l=(s?.batch?.students||[]).map(i=>({studentId:i.studentId,batchId:s.batch._id,fullName:i.fullName,email:i.email,present:!1}));d(l)}).catch(t=>{const s=t.response?.data?.message||"Failed to fetch session details";o.fire({icon:"warning",title:"Warning",text:s,confirmButtonText:"OK"}),console.error("Failed to fetch session details:",t)}).finally(()=>h(!1))},[r]);const j=t=>{const s=[...a];s[t].present=!s[t].present,d(s)},N=()=>{const t=!m;b(t),d(s=>s.map(n=>({...n,present:t})))},y=()=>{!r||a.length===0||o.fire({icon:"warning",title:"Are you sure?",text:"Once submitted, you won’t be able to update or change attendance!",showCancelButton:!0,confirmButtonColor:"#2563eb",cancelButtonColor:"#9ca3af",confirmButtonText:"Yes, Submit",cancelButtonText:"Cancel"}).then(t=>{if(t.isConfirmed){const s={attendees:a.map(({studentId:n,batchId:l,present:i})=>({studentId:n,batchId:l,present:i}))};u.post(`/api/attendance/mark/${r}`,s).then(n=>{o.fire({icon:"success",title:"Success",text:n.data?.message||"Attendance marked successfully!",confirmButtonText:"OK"}).then(()=>{f(-1)})}).catch(n=>{const l=n.response?.data?.message||"Please try again!";o.fire({icon:"error",title:"Error",text:l,confirmButtonText:"OK"})})}})};return x?e.jsx("div",{children:"Loading session..."}):p?a.length?e.jsx("div",{className:"max-h-fit",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 px-8 py-3 flex justify-between items-center text-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-1",children:"Attendance Records"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Manage Participate attendance for this session"})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl px-4 py-2 text-center",children:[e.jsx("div",{className:"text-sm text-blue-100",children:"Total Participate"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:a.length})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-sm text-blue-100",children:"Mark All"}),e.jsx("button",{onClick:N,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 ${m?"bg-green-400":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${m?"translate-x-6":"translate-x-1"}`})})]})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"overflow-hidden rounded-xl border border-gray-200 shadow-sm",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700 text-sm uppercase",children:"Participate"}),e.jsx("th",{className:"px-6 py-4 text-left font-semibold text-gray-700 text-sm uppercase",children:"Email"}),e.jsx("th",{className:"px-6 py-4 text-center font-semibold text-gray-700 text-sm uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-center font-semibold text-gray-700 text-sm uppercase",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:a.map((t,s)=>e.jsxs("tr",{className:"transition hover:bg-blue-50/50",children:[e.jsxs("td",{className:"px-6 py-4 flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center text-white font-semibold mr-4",children:t.fullName.split(" ").map(n=>n[0]).join("")}),e.jsx("div",{className:"font-semibold text-gray-800",children:t.fullName})]}),e.jsx("td",{className:"px-6 py-4 text-gray-600",children:t.email}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${t.present?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:[e.jsx("span",{className:`w-2 h-2 rounded-full mr-2 ${t.present?"bg-green-500":"bg-red-500"}`}),t.present?"Present":"Absent"]})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>j(s),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${t.present?"bg-green-500":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${t.present?"translate-x-6":"translate-x-1"}`})})})]},t.studentId))})]})}),e.jsxs("div",{className:"flex justify-between items-center mt-8 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Present:"," ",e.jsx("strong",{children:a.filter(t=>t.present).length})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Absent:"," ",e.jsx("strong",{children:a.filter(t=>!t.present).length})]})]})]}),e.jsx("button",{onClick:y,disabled:a.length===0||x,className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-3 rounded-xl font-semibold shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"⏳"}),e.jsx("span",{children:"Submitting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"✅"}),e.jsx("span",{children:"Submit Attendance"})]})})]})]})]})})}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-10 px-6 mt-50 bg-yellow-50 border border-yellow-300 rounded-lg text-yellow-800 space-y-2",children:[e.jsx(A,{className:"w-8 h-8"}),e.jsx("h3",{className:"text-lg font-semibold",children:"No participates found in this batch"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Please check the batch or add participates to mark attendance."})]}):e.jsx("div",{children:"No session data available."})};export{S as default};
