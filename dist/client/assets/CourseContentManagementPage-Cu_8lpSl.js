import{j as e,b7 as C,F as f,c as N,e as v,i as c,b8 as V,d as x,b as k,u as S,r as u,aJ as A,b9 as F,ba as q,m as D}from"./index-BlaCQYdb.js";import{a as L}from"./index-B3h-wylh.js";const T=({note:s})=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:bg-gray-100 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-sm mb-1",children:s.title}),e.jsx("div",{className:"flex items-center text-xs text-gray-500 mb-2",children:s.duration&&e.jsxs("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded mr-2",children:["â±ï¸ ",s.duration]})}),s.content&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:s.content})]}),s.file&&e.jsx("a",{href:`${C}/uploads/course-notes/${s.file}`,target:"_blank",rel:"noopener noreferrer",className:"ml-4 bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-sm transition-colors duration-200",children:"ðŸ“„ View"})]})},s._id),U=N().shape({title:x().required("Title is required"),content:x().required("Content is required"),duration:x(),file:V()}),E=({courseId:s,token:n,onSuccess:r,onError:m,addNoteToCourse:b})=>e.jsx(f,{initialValues:{title:"",content:"",duration:"",file:null},validationSchema:U,onSubmit:async(a,{resetForm:d,setSubmitting:i})=>{try{const t=new FormData;t.append("title",a.title),t.append("content",a.content),t.append("duration",a.duration||""),t.append("uploadedAt",new Date().toISOString()),a.file instanceof File&&t.append("file",a.file);const o=await b(s,t,n);o.success?(r("Note added successfully!"),d()):m(o.message||"Failed to add note.")}catch(t){m(t.message||"An error occurred while adding the note.")}finally{i(!1)}},children:({isSubmitting:a,setFieldValue:d})=>e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (MM:SS)"}),e.jsx(c,{type:"text",name:"duration",placeholder:"00:00",className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"File Type"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"PDF Upload"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note Title"}),e.jsx(c,{type:"text",name:"title",className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content Description"}),e.jsx(c,{as:"textarea",name:"content",rows:3,className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload PDF File"}),e.jsx("input",{type:"file",accept:".pdf",onChange:i=>{const t=i.currentTarget.files[0];d("file",t)},className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-4 rounded-lg",children:a?"Adding Note...":"ðŸ“ Add Note"})]})}),M=N().shape({title:x().required("Title is required"),contentUrl:x().url("Must be a valid URL").required("Video URL is required"),duration:x().required("Duration is required"),type:x().required("Type is required"),description:x()}),P=({courseId:s,token:n,onSuccess:r,onError:m,addVideoToCourse:b})=>e.jsx(f,{initialValues:{type:"video",title:"",contentUrl:"",duration:"",description:""},validationSchema:M,onSubmit:async(a,{resetForm:d,setSubmitting:i})=>{try{const t={...a,course:s},o=await b(s,t,n);o.success?(r("Video added successfully!"),d()):m(o.message||"Failed to add video.")}catch(t){m(t.message||"An error occurred while adding the video.")}finally{i(!1)}},children:({isSubmitting:a,errors:d,touched:i})=>e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),e.jsxs(c,{as:"select",name:"type",className:"w-full border border-gray-300 rounded-lg px-4 py-2",children:[e.jsx("option",{value:"video",children:"Video"}),e.jsx("option",{value:"lecture",children:"Lecture"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (MM:SS)"}),e.jsx(c,{type:"text",name:"duration",placeholder:"00:00",className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video Title"}),e.jsx(c,{type:"text",name:"title",className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Video URL"}),e.jsx(c,{type:"url",name:"contentUrl",placeholder:"https://example.com/video.mp4",className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx(c,{as:"textarea",name:"description",rows:3,className:"w-full border border-gray-300 rounded-lg px-4 py-2"})]}),e.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-4 rounded-lg",children:a?"Adding Video...":"âž• Add Video"})]})}),_=({video:s,setSelectedVideo:n})=>e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200 hover:bg-gray-100 transition-colors duration-200",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-sm mb-1",children:s.title}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mb-2",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded mr-2",children:s.type}),e.jsxs("span",{children:["â±ï¸ ",s.duration]})]}),s.description&&e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:s.description})]}),e.jsx("button",{onClick:()=>n(s),className:"ml-4 bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded-lg text-sm transition-colors duration-200",children:"â–¶ Play"})]})},s._id),B=()=>{const{courseId:s}=k(),{token:n}=S(),[r,m]=u.useState(null),[b,a]=u.useState(!0),[d,i]=u.useState(""),[t,o]=u.useState(""),[p,w]=u.useState(null),g=async()=>{a(!0),i("");try{const l=await D(s);m(l)}catch(l){i("Failed to load course details."),console.error("Error fetching course:",l)}finally{a(!1)}};return u.useEffect(()=>{g()},[s]),b?e.jsx("p",{children:"Loading course details..."}):d&&!r?e.jsx("p",{style:{color:"red"},children:d}):e.jsx("div",{className:"min-h-screen bg-gray-800 py-8 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs(A,{to:"/courses",className:"inline-flex items-center text-blue-600 hover:text-blue-800 font-medium mb-6",children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"Back to Course List"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-8 border border-gray-200",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Course Content Manager"}),e.jsx("h2",{className:"text-xl text-blue-700 font-semibold",children:r?.title}),e.jsx("p",{className:"text-gray-600 mt-2",children:r?.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 mt-4",children:[e.jsxs("div",{className:"bg-blue-50 px-4 py-2 rounded-lg border border-blue-200",children:[e.jsxs("span",{className:"text-sm text-blue-700 font-medium",children:["Videos:"," "]}),e.jsx("span",{className:"font-bold",children:r?.videolectures?.length||0})]}),e.jsxs("div",{className:"bg-green-50 px-4 py-2 rounded-lg border border-green-200",children:[e.jsxs("span",{className:"text-sm text-green-700 font-medium",children:["Notes:"," "]}),e.jsx("span",{className:"font-bold",children:r?.notes?.length||0})]}),e.jsxs("div",{className:"bg-purple-50 px-4 py-2 rounded-lg border border-purple-200",children:[e.jsxs("span",{className:"text-sm text-purple-700 font-medium",children:["Duration:"," "]}),e.jsx("span",{className:"font-bold",children:r?.duration||"N/A"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[d&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-4",children:e.jsx("span",{className:"text-red-700 font-medium",children:d})}),t&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 mb-4",children:e.jsx("span",{className:"text-green-700 font-medium",children:t})})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Add New Video"}),e.jsx(P,{courseId:s,token:n,onSuccess:o,onError:i,addVideoToCourse:async(l,j,y)=>{const h=await F(l,j);return h.success&&await g(),h}})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Add New Note"}),e.jsx(E,{courseId:s,token:n,onSuccess:o,onError:i,addNoteToCourse:async(l,j,y)=>{const h=await q(l,j,y);return h.success&&await g(),h}})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:"Existing Course Content"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:[r?.videolectures?.length||0," Videos"]}),e.jsxs("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium",children:[r?.notes?.length||0," Notes"]})]})]}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2 w-5 h-5 inline-block bg-blue-600 rounded"}),"Video Lectures"]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r?.videolectures?.length>0?r.videolectures.map(l=>e.jsx(_,{video:l},l._id)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No videos available"})})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2 w-5 h-5 inline-block bg-green-600 rounded"}),"Study Notes"]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r?.notes?.length>0?r.notes.map(l=>e.jsx(T,{note:l},l._id)):e.jsx("p",{className:"text-gray-500 text-sm",children:"No notes available"})})]})]})]}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h4",{className:"text-xl font-semibold text-gray-900",children:p.title}),e.jsx("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-600 text-2xl font-bold","aria-label":"Close",children:"Ã—"})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("video",{src:p.url,controls:!0,className:"w-full h-auto rounded-lg",autoPlay:!0}),e.jsx("p",{className:"mt-4 text-gray-700",children:p.description})]})]})})]})})};export{B as default};
