import{a as y,r,q as j,j as t,w as x,t as N,a1 as h,S as s}from"./index-BlaCQYdb.js";const v=()=>{const o=y(),[m,n]=r.useState([]),[g,l]=r.useState(!1),[i,c]=r.useState(null),{rolePermissions:d}=j(e=>e.permissions),f=[{header:"Test Name",accessor:e=>e.title||"Untitled"},{header:"Level",accessor:e=>e.testLevel||"N/A"},{header:"Duration",accessor:e=>`${e.testDuration?.minutes||0}m ${e.testDuration?.seconds||0}s`},{header:"Total Marks",accessor:e=>e.totalMarks||"--"},{header:"Actions",accessor:e=>t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-all",onClick:()=>o(`/view-excel/${e._id}`),children:"ðŸ“‚ View"}),t.jsx("button",{className:"bg-purple-500 text-white px-4 py-2 rounded-lg",onClick:()=>p(e._id),children:"ðŸ”— Share Test"}),x(d,"test","delete")&&t.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition-all",onClick:()=>b(e._id),children:"ðŸ—‘ï¸ Delete"})]})}],p=e=>{const a=`${window.location.origin}/start-test/${e}`;navigator.clipboard.writeText(a),s.fire({icon:"success",title:"Test Link Copied!",text:a,confirmButtonText:"OK"})},u=async()=>{l(!0),c(null);try{const e=await h.get("/api/tests");console.log("API Response:",e.data),e.data?.data&&Array.isArray(e.data.data)?n(e.data.data):n([])}catch(e){console.error("Error fetching tests:",e),c("Failed to fetch tests. Please try again."),s.fire({icon:"error",title:"Oops...",text:e.response?.data?.message||"Error fetching data"})}finally{l(!1)}};r.useEffect(()=>{u()},[]);const b=async e=>{if((await s.fire({title:"Are you sure?",text:"Do you want to delete this test?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await h.delete(`/api/tests/${e}`),s.fire("Deleted!","Test has been deleted.","success"),u()}catch(a){s.fire("Error!",a.response?.data?.message||"Failed to delete test.","error")}};return t.jsxs("div",{className:"max-w-full h-full mx-auto p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h2",{className:"text-3xl font-bold text-gray-800",children:"All Tests ðŸ“˜"}),x(d,"test","create")&&t.jsx("button",{className:"bg-green-500 text-white px-4 py-2 rounded-lg shadow-md hover:bg-green-600 transition-all",onClick:()=>o("/add-test"),children:"+ Add Assessment Test"})]}),g&&t.jsx("p",{className:"text-blue-500 font-semibold",children:"Loading..."}),i&&t.jsx("p",{className:"text-red-500 font-semibold",children:i}),t.jsx(N,{columns:f,data:m,maxHeight:"500px",emptyMessage:"No tests found."})]})};export{v as default};
