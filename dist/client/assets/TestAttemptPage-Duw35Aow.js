import{b as T,a as v,r,aX as $,j as s}from"./index-BlaCQYdb.js";import{t as g}from"./TestServices-iIG0093W.js";const k=()=>{const{testId:u}=T(),x=v(),{currentUser:y}=r.useContext($),i=y?.token,[m,b]=r.useState(null),[o,d]=r.useState([]),[w,c]=r.useState(!0),[p,l]=r.useState(""),[f,h]=r.useState(!1);r.useEffect(()=>{if(!i){l("Please log in to attempt the test."),c(!1);return}(async()=>{try{c(!0);const t=await g.getTestById(u,i);b(t),d(new Array(t.questions.length).fill(null)),l("")}catch(t){l(t.response?.data?.message||"Failed to load the test."),console.error(t)}finally{c(!1)}})()},[u,i]);const j=(n,t)=>{const e=[...o];e[n]=t,d(e)},S=async n=>{n.preventDefault();const t=o.filter(e=>e===null).length;if(!(t>0&&typeof window<"u"&&!window.confirm(`You have ${t} unanswered questions. Are you sure you want to submit?`))){h(!0);try{const e={testId:u,answers:o};await g.submitTest(e,i),x("/my-results",{state:{message:"Test submitted successfully!"}})}catch(e){l(e.response?.data?.message||"Failed to submit the test."),console.error(e)}finally{h(!1)}}};return w?s.jsx("div",{className:"container",children:"Loading Test..."}):p?s.jsxs("div",{style:{color:"red"},children:["Error: ",p]}):s.jsxs("div",{className:"test-attempt-container",style:{padding:"20px",maxWidth:"900px",margin:"auto"},children:[s.jsx("h2",{style:{marginBottom:"20px",textAlign:"center"},children:m?.title}),s.jsxs("form",{onSubmit:S,children:[m?.questions.map((n,t)=>s.jsxs("div",{style:{marginBottom:"25px",border:"1px solid #f0f0f0",padding:"20px",borderRadius:"8px"},children:[s.jsx("h4",{style:{marginTop:0},children:`Q${t+1}: ${n.questionText}`}),n.options.map((e,a)=>s.jsxs("label",{htmlFor:`q${t}-o${a}`,style:{display:"flex",alignItems:"flex-start",marginBottom:"12px",cursor:"pointer"},children:[s.jsx("input",{type:"radio",id:`q${t}-o${a}`,name:`question-${t}`,value:a,checked:o[t]===a,onChange:()=>j(t,a),style:{marginRight:"12px",marginTop:"4px",flexShrink:0}}),s.jsx("span",{children:e})]},a))]},n._id||t)),s.jsx("button",{type:"submit",disabled:f,className:"button button-primary",style:{padding:"12px 25px",fontSize:"16px",cursor:"pointer",width:"100%"},children:f?"Submitting...":"Submit Test"})]})]})};export{k as default};
